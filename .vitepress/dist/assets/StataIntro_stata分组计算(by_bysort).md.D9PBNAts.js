import{_ as a,c as e,a as i,l as s,a1 as t,o as p}from"./chunks/framework.ZVjbeeCo.js";const _=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"StataIntro/stata分组计算(by,bysort).md","filePath":"StataIntro/stata分组计算(by,bysort).md"}'),n={name:"StataIntro/stata分组计算(by,bysort).md"},d=s("h2",{id:"stata分组计算-by-bysort",tabindex:"-1"},[i("stata分组计算(by,bysort) "),s("a",{class:"header-anchor",href:"#stata分组计算-by-bysort","aria-label":'Permalink to "stata分组计算(by,bysort)"'},"​")],-1),h=s("div",{style:{"text-align":"center"}},[s("div",{style:{border:"2px solid #ccc",padding:"10px",display:"inline-block"}},[s("iframe",{src:"//player.bilibili.com/player.html?bvid=BV1kJ411b7Nj&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",style:{width:"750px",height:"450px"}})])],-1),o=t(`<p>大家好！今天，我想分享如何在 Stata 中实现分组计算。在数据处理过程中，我们常常需要计算不同组别或不同类别的平均值、标准差或其他统计变量。为了更好地说明分组计算的概念和应用方法，我们将使用一个包含车辆价格、制造商和其他特征（例如是国内还是国外制造商）的数据集。</p><p>假设我们对的研究题目是：国外制造的车辆的价格是否比国内制造的车辆的价格更高？为了实现这个简单的目的，我们需要计算国内车辆的平均价格和国外车辆的平均价格。</p><p>要实现分组计算，我们可以使用 Stata 中的 <code>by</code> 命令。<code>by</code> 命令的语法非常简单，只需要在 <code>by</code> 后面跟上分类变量，例如我们这里的 <code>foreign</code> 变量，它表示汽车是国内生产还是国外生产的。然后，我们可以使用 <code>egen</code> 命令（<code>generate</code> 命令的简写）来计算平均值。</p><div class="language-stata vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">stata</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bysort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> foreign : </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">egen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mean_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(price)</span></span></code></pre></div><p>上面的命令首先按照 <code>foreign</code> 变量分组，然后计算 <code>price</code> 的平均值，并将其生成为一个新的变量 <code>mean_price</code>。</p><p>现在，我们可以运行上面的命令，并查看输出结果。在数据表中，我们可以看到生成了一个新的变量 <code>mean_price</code>。我们可以看到，对于同一组别的平均值是相同的，但不同组别的平均值有差距。例如，国外车辆的平均价格是 6384，而国内车辆的平均价格只有 6072。这也间接证明了国外生产的价格比国内的更高。</p><p>如果我们想计算其他统计量，例如标准差和中位数，我们可以继续使用 <code>egen</code> 命令。</p><div class="language-stata vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">stata</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bysort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> foreign : </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">egen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> std_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(price)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bysort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> foreign: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">egen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> median_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> median</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(price)</span></span></code></pre></div><p>上面的命令分别计算 <code>price</code> 的标准差和中位数，并将其生成为新的变量 <code>std_price</code> 和 <code>median_price</code>。我们可以看到，使用中位数可以更清晰地区分不同组别，并且我们也可以计算出它们的标准差。</p><p>由于 <code>egen</code> 命令没有直接生成方差的命令，我们可以直接使用标准差的平方来计算方差。</p><div class="language-stata vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">stata</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">gen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> variance_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">std_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">)^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span></code></pre></div><p>现在，我们已经计算出了三个分组的统计量。但是，如果我们想按照国内/国外以及制造商这两个变量来分组，该如何做？我们可以使用 <code>bysort</code> 命令，它将 <code>sort</code> 和 <code>by</code> 命令合并在一起。</p><div class="language-stata vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">stata</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bysort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> foreign make: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">egen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mean_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(price)</span></span></code></pre></div><p>上面的命令首先按照 <code>foreign</code> 和 <code>make</code> 变量排序，然后计算 <code>price</code> 的平均值，并将其生成为新的变量 <code>mean_price</code>。我们可以看到，使用 <code>bysort</code> 命令可以更加简单地实现分组计算。</p><p>总之，通过简单的 <code>by</code> 和 <code>bysort</code> 命令，我们可以轻松实现 Stata 的分组计算。</p><hr>`,16);function l(c,r,k,g,y,E){return p(),e("div",null,[d,h,i(" # "),o])}const m=a(n,[["render",l]]);export{_ as __pageData,m as default};
